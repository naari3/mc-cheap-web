(this["webpackJsonpmc-cheap-web"]=this["webpackJsonpmc-cheap-web"]||[]).push([[0],{23:function(e,t,a){e.exports=a(49)},42:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},49:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(0),s=a.n(c),l=a(21),u=a.n(l),o=(a(42),a(2)),i=(a(43),function(e){var t=Object(c.useGlobal)("currentUser"),a=Object(o.a)(t,1)[0];return a?a.allowed?s.a.createElement(s.a.Fragment,null,e.children):s.a.createElement("div",{className:"NotAllowed"},s.a.createElement("p",null,s.a.createElement("a",{href:"https://twitter.com/_naari_"},"\u306a\u3042\u308a"),"\u306e\u30d5\u30a9\u30ed\u30ef\u30fc\u3057\u304b\u89e6\u308c\u307e\u305b\u3093\uff08\uff1b\uff3f\uff1b\uff09"),s.a.createElement("p",null,s.a.createElement("a",{href:"https://twitter.com/_naari_"},"\u306a\u3042\u308a"),"\u306b\u30d5\u30a9\u30ed\u30fc\u3057\u3066\u3082\u3089\u3063\u3066\u304f\u3060\u3055\u3044\uff08\uff1b\uff3f\uff1b\uff09"),s.a.createElement("p",null,"\u3057\u3066\u3082\u3089\u3063\u305f\u3042\u3068\u306b\u3082\u3046\u4e00\u5ea6",s.a.createElement("a",{href:"".concat("https://api.mc.naari3.net","/auth/twitter")},"\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044"))):s.a.createElement("p",null,s.a.createElement("a",{href:"".concat("https://api.mc.naari3.net","/auth/twitter")},"\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044"))}),m=function(e){var t=Object(c.useGlobal)("loading");return Object(o.a)(t,1)[0]?s.a.createElement("div",{className:"Loading"},"\u308d\u30fc\u3067\u3043\u3093\u3050"):s.a.createElement(s.a.Fragment,null,e.children)},p="https://api.mc.naari3.net",b=function(){var e,t;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(e="",e=JSON.parse(window.localStorage.token||"null")){a.next=14;break}return a.next=5,r.a.awrap(fetch("".concat(p,"/token"),{mode:"cors",credentials:"include"}));case 5:if(200!==(t=a.sent).status){a.next=13;break}return a.next=9,r.a.awrap(t.json());case 9:e=a.sent.token,window.localStorage.token=JSON.stringify(e),a.next=14;break;case 13:throw"token failed";case 14:return a.abrupt("return",e);case 15:case"end":return a.stop()}}))},f=function(e,t){var a;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t||(t={}),t.mode="cors",n.t0="Bearer ",n.next=5,r.a.awrap(b());case 5:return n.t1=n.sent,n.t2=n.t0.concat.call(n.t0,n.t1),t.headers={"Content-Type":"application/json",Authorization:n.t2},n.next=10,r.a.awrap(fetch(p+e,t));case 10:return 401===(a=n.sent).status&&window.localStorage.removeItem("token"),n.abrupt("return",a);case 13:case"end":return n.stop()}}))},d={InService:"\u3084\u3063\u3066\u307e\u3059",Launching:"\u3082\u3046\u3061\u3087\u3063\u3068\u3067\u3059",Pending:"\u305f\u3066\u3066\u308b\u3068\u3053\u308d\u3067\u3059",Terminating:"\u304a\u3068\u3057\u3066\u307e\u3059",Terminated:"\u3084\u3063\u3066\u307e\u305b\u3093"},h=function(){var e=Object(c.useGlobal)("message"),t=Object(o.a)(e,2)[1],a=Object(c.useGlobal)("serverStatus"),n=Object(o.a)(a,2),l=n[0],u=n[1],i=Object(c.useGlobal)("launching"),m=Object(o.a)(i,2),p=m[0],b=m[1],h=function(){var e,a;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(f("/instance_status"));case 2:return 200!==(e=n.sent).status&&t("\u306a\u3093\u304b\u304a\u304b\u3057\u3044\u3001\u9023\u7d61\u3057\u3066\u304f\u3060\u3055\u3044"),n.next=6,r.a.awrap(e.json());case 6:a=n.sent.status,p&&"InService"===a&&(b(!1),t("\u305f\u3063\u305f\uff01")),u(a);case 9:case"end":return n.stop()}}))};return Object(c.useEffect)((function(){var e=setInterval(h,7e3);return function(){clearInterval(e)}})),s.a.createElement("div",{className:"Status"},d[l])},E=function(){var e=Object(c.useState)(0),t=Object(o.a)(e,2),a=t[0],n=t[1],l=function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:n(a+1);case 1:case"end":return e.stop()}}))};return Object(c.useEffect)((function(){var e=setInterval(l,7e3);return function(){clearInterval(e)}})),s.a.createElement("div",{className:"Banner"},s.a.createElement("iframe",{key:a,src:"https://mc.erinn.biz/intl/polling.html.php?server_addr=mc.naari3.net",style:{width:"300px",height:"60px",border:"none"}}))},v=function(){var e=Object(c.useGlobal)("loading"),t=Object(o.a)(e,2)[1],a=Object(c.useGlobal)("message"),n=Object(o.a)(a,2)[1],l=Object(c.useGlobal)("serverStatus"),u=Object(o.a)(l,1)[0],i=Object(c.useGlobal)("launching"),m=Object(o.a)(i,2),p=m[0],b=m[1];return s.a.createElement("div",{className:"Boot"},s.a.createElement("p",null,"\u843d\u3061\u3066\u308b\u6642\u306b\u304d\u3069\u3046\u3059\u308b\u305f\u3081\u306e\u30dc\u30bf\u30f3"),s.a.createElement("button",{disabled:"Terminated"!==u||p,onClick:function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return t(!0),e.next=3,r.a.awrap(f("/boot",{method:"POST"}));case 3:200===e.sent.status?(n("\u305f\u3061\u3042\u3052\u307e\u3059\u30012\u5206\u304f\u3089\u3044\u307e\u3063\u3066\u3066"),b(!0)):n("\u5931\u6557\u3057\u307e\u3057\u305f\u2026\u306a\u3093\u3067\u2026"),t(!1);case 6:case"end":return e.stop()}}))}},"\u304d\u3069\u3046"))},O=(a(44),function(){var e=Object(c.useGlobal)("currentUser"),t=Object(o.a)(e,2),a=t[0],n=t[1],l=Object(c.useGlobal)("message"),u=Object(o.a)(l,2)[1],i=Object(c.useState)(!1),m=Object(o.a)(i,2),p=m[0],b=m[1];return s.a.createElement("div",{className:"McName"},s.a.createElement("p",null,"\u30de\u30a4\u30af\u30e9\u3067\u3064\u304b\u3063\u3066\u308b\u30e6\u30fc\u30b6\u30fc\u540d\u3092\u3044\u308c\u3066\u304b\u3089\u300c\u3053\u3046\u3057\u3093\u300d\u3092\u304a\u3057\u3066\u304f\u3060\u3055\u3044"),s.a.createElement("p",null,"\u3053\u308c\u306b\u3088\u3063\u3066\u30db\u30ef\u30ea\u30b9\u306b\u30e6\u30fc\u30b6\u30fc\u540d\u304c\u8ffd\u52a0\u3055\u308c\u308b\u306f\u305a"),s.a.createElement("form",{onSubmit:function(e){var t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.preventDefault(),b(!0),console.log({mcUsername:a.mcUsername}),u("\u3053\u3046\u3057\u3093\u3057\u3066\u3044\u307e\u3059\u2026"),n.next=6,r.a.awrap(f("/user",{method:"PUT",body:JSON.stringify({mcUsername:a.mcUsername})}));case 6:200===(t=n.sent).status?u("\u30e6\u30fc\u30b6\u30fc\u540d\u3053\u3046\u3057\u3093\u3057\u307e\u3057\u305f\uff01\uff01\uff01\uff01"):403===t.status?u("\u30b5\u30fc\u30d0\u30fc\u304c\u305f\u3063\u3066\u308b\u3068\u304d\u306b\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\uff01\uff01\uff01\uff01"):u("\u30e6\u30fc\u30b6\u30fc\u540d\u3053\u3046\u3057\u3093\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u2026\u4f1d\u3048\u3066\u304f\u3060\u3055\u3044\u2026"),b(!1);case 9:case"end":return n.stop()}}))}},"@",s.a.createElement("input",{type:"text",defaultValue:a.mcUsername,size:16,className:"McName-Input",onChange:function(e){a.mcUsername=e.target.value,n(a)}}),s.a.createElement("button",{disabled:p},"\u3053\u3046\u3057\u3093")))}),w=function(){var e=Object(c.useGlobal)("currentUser"),t=Object(o.a)(e,1)[0],a=Object(c.useGlobal)("message"),n=Object(o.a)(a,1)[0],r=Object(c.useGlobal)("serverStatus"),l=Object(o.a)(r,1)[0];return s.a.createElement("div",{className:"App"},s.a.createElement("h1",null,"\u307e\u3044\u304f\u3089\u3055\u30fc\u3070\u30fc"),s.a.createElement("p",null,"\u307e\u3044\u304f\u3089\u30b5\u30fc\u30d0\u30fc mc.naari3.net \u306e\u30b3\u30f3\u30d1\u30cd"),s.a.createElement(m,null,s.a.createElement(i,null,t?s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,t.name,"\u3055\u3093\u3053\u3093\u306b\u3061\u306f"),s.a.createElement("p",null,"\u3067\u3043\u3059\u3053\u30fc\u3069\u3055\u30fc\u3070\u30fc\u3042\u308a\u307e\u3059"),s.a.createElement("a",{href:Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_API_HOST:"https://api.mc.naari3.net"}).REACT_APP_DISCORD_INVITE_URL},Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_API_HOST:"https://api.mc.naari3.net"}).REACT_APP_DISCORD_INVITE_URL),s.a.createElement("h2",null,"\u3059\u3066\u30fc\u305f\u3059"),s.a.createElement(h,null),s.a.createElement(E,null),"InService"===l?s.a.createElement(s.a.Fragment,null,s.a.createElement("h2",null,"\u307e\u3044\u304f\u3089\u306e\u306a\u307e\u3048"),s.a.createElement(O,null)):s.a.createElement(s.a.Fragment,null),s.a.createElement("h2",null,"\u305f\u3061\u3042\u3052\u308b"),s.a.createElement(v,null)):s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,s.a.createElement("a",{href:"".concat("https://api.mc.naari3.net","/auth/twitter")},"\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044")))),s.a.createElement("p",null,n)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(45);Object(c.setGlobal)({loading:!0}),function(){var e,t,a;r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r.a.awrap(f("/user"));case 3:if(200!==(t=n.sent).status){n.next=9;break}return n.next=7,r.a.awrap(t.json());case 7:a=n.sent,e=a.user;case 9:setTimeout((function(){var t;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=function(){var e;return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.awrap(f("/instance_status"));case 2:return e=t.sent,t.next=5,r.a.awrap(e.json());case 5:return t.abrupt("return",t.sent.status);case 6:case"end":return t.stop()}}))},a.t0=c.setGlobal,a.t1=e||null,a.next=5,r.a.awrap(t());case 5:a.t2=a.sent,a.t3={currentUser:a.t1,loading:!1,serverStatus:a.t2},(0,a.t0)(a.t3);case 8:case"end":return a.stop()}}))}),1e3),n.next=17;break;case 12:n.prev=12,n.t0=n.catch(0),console.error(n.t0),console.log("may be not logged in"),setTimeout((function(){Object(c.setGlobal)({currentUser:null,loading:!1,serverStatus:"Terminated"})}),1e3);case 17:case"end":return n.stop()}}),null,null,[[0,12]])}(),u.a.render(s.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[23,1,2]]]);
//# sourceMappingURL=main.39db1236.chunk.js.map